<!doctype html> <!-- dont forget: change the Pluto link at the script below, and 'Pluto.run(require_secret_for_open_links=false, require_secret_for_access=false)' from Julia cmd -->
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>ML4Chem by Beryl</title>

		<link rel="stylesheet" href="../../../etc/reveal.js/dist/reset.css">
		<link rel="stylesheet" href="../../../etc/reveal.js/dist/reveal.css">
		<link rel="stylesheet" href="../../../etc/reveal.js/dist/theme/simple.css">
		<link rel="stylesheet" href="shd_styles.css">
		<link rel="stylesheet" href="../../../etc/reveal.js/plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section data-background-image="assets/images/bg_sakura.gif" data-background-opacity=0.45>
					<div class = "text-pad">
						<div class="bgcolor">
							<h3 style="color:blue; font-family:'Comic Sans MS',cursive;"><strong>Machine learning</strong> for <br> chemical data</h3>
						</div>
						<p style="font-family: 'Comic Sans MS', cursive; font-size: 0.7em;"> <a href="https://berylgithub.github.io/cv/"> Beryl Ramadhian Aribowo </a> </p>
						<p style="font-family: 'Comic Sans MS', cursive; font-size: 0.7em;">Faculty of Mathematics, University of Vienna, Vienna, Austria</p>
					</div>
					<div class="logo-container">
						<img src="assets/images/logo_vgsco.png" alt="VGSCO logo">
						<img src="assets/images/logo_julia.png" alt="Julia logo">
						<img src="assets/images/logo_uniwien.png" alt="Uni Wien logo">
					</div>
				</section>
				<section id="sections" style="font-family:'Comic Sans MS',cursive; font-size: 35px;" data-background-image="assets/images/bg_sakura.gif" data-background-opacity=0.45>
					<h3 style="color:blue; font-family:'Comic Sans MS',cursive;">Sections</h3>
					<div>
						<ol>
							<li>
								<a href="#/preliminary">Preliminary: general processes</a>
							</li>
							<li>
								<a href="#/ppes">Pair potential energy surface</a>
							</li>
							<li>
								<a href="#/bpes">Global potential energy surface for small molecules</a>
							</li>
							<li>
								<a href="#/rosemi">Robust Shepard model for interpolation</a>
							</li>
							<li>
								<a href="#/qm9">Learning equilibrium geometries by minimal supervision</a>
							</li>
						</ol>
					</div>
				</section>
				<!-- ======== Preliminary chapter: explains data, features, and fitting ================ -->
				<section> 
					<section id="preliminary" data-background-image="assets/images/bg_sakura.gif" data-background-opacity=0.45>
						<h3 style="color:blue; font-family:'Comic Sans MS',cursive; ">Preliminary</h3>
						<div style="font-family:'Comic Sans MS',cursive; font-size: 35px;">
							<ul>
								<li>
									One-line-summary
								</li>
								<li>
									Motivation
								</li>
								<li>
									Process flow
								</li>
								<li>
									Molecular data
								</li>
								<li>
									Feature extraction
								</li>
								<li>
									Fitting: modelling and optimization
								</li>
								<li>
									Evaluation
								</li>
							</ul>
						</div>
					</section>
					<section>
						<h4 style="color:green; font-family:'Comic Sans MS',cursive;">Single-line-summary</h4>
						<img src="assets/images/matheq.drawio.svg" alt="Single line summary">
					</section>
					<section>
						<h4 style="color:green; font-family:'Comic Sans MS',cursive;">Motivation</h4>
						
						<img src="assets/images/acc_plot.png" alt="Methods accuracy" style="position:relative; top:-70px">
						<div style="position: relative; top:-70px; font-family:'Comic Sans MS',cursive; font-size: 20px;">
							Adapted from Lilienfeld (2018).	
						</div>
						
					</section>
					<section>
						<h4 style="color:green; font-family:'Comic Sans MS',cursive;">Process flow</h4>
						<img src="assets/images/process_flow.svg" alt="Process flow of chemical ML">
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS',cursive;">Data</h4>
						<div style="position:relative; left:-100px; text-align: left; font-size: 25px;">
							<p>Molecular data:</p>
							<ul>
								<li>
									Atomic coordinates $\textcolor{blue} X \in \mathbb{R}^{n_\text{atom} \times 3}$ 
									<br>(units: <span style="color:blueviolet">1 Angstrom = 1.89 Bohr</span>)
								</li>
								<li>
									List of atoms' type, e.g., $[\text{C, H, O, O, ...}]$
								</li>
								<li>
									Target property (in this case, energy) $\textcolor{green}E \in \mathbb{R}$ 
									<br>(units: <span style="color:blueviolet">1 Hartree = 27.2 eV = 627.5 kcal/mol</span>)
								</li>
							</ul>
							<p>Additional data:</p>
							<ul>
								<li>
									Nuclear charge $Z_i \in \mathbb{Z}^+$ of atom $i$
								</li>
								<li>
									Connection information in SMILES string format
								</li>
							</ul>
						</div>
						<img src="assets/images/data_file4.svg" alt="Molecular file example">
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS',cursive;">Feature extraction</h4>
						<div style="position:relative; left:-100px; width:70%; text-align: left; font-size: 25px;">
							<ul>
								<li>
									Graph features: <span style="color:rgb(68, 68, 255)">dressed atom</span>, <span style="color:rgb(0, 0, 255)">dressed bond</span>, <span style="color:rgb(0, 0, 173)">dressed angle</span>, ...
								</li>
								<li>
									$n$-body features: <span style="color:rgb(0, 0, 255)">distance</span>, <span style="color:rgb(0, 0, 173)">angular</span>, <span style="color:rgb(0, 0, 81)">dihedral</span>, ...
								</li>
								<li>
									Feature selection: principal component analysis (PCA)
								</li>
								<li>
									Main properties: invariant to <span style="color:blue">translation</span>, <span style="color:blue">rotation</span> and <span style="color:blue">permutation</span> (of atoms with same type)
								</li>
								<li>
									Typically encoded in a matrix $\textcolor{blue} \Phi^m \in \mathbb{R}^{n^m_\text{atom} \times n_\text{feature}}$ or a vector $\textcolor{blue} \phi_{m:} \in \mathbb{R}^{n_\text{feature}}$ for molecule $m$  
								</li>
							</ul>
						</div>
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS'">Fitting</h4>
						<div class="two-columns">
							<div class="left-column" style="font-family:'Comic Sans MS'; font-size: 20px" >
								<h6 style="font-family:'Comic Sans MS'"><u>Model</u></h6>
								<ul>
									<li>
										General form: $\textcolor{green} E_m \approx V(\textcolor{blue} x_m, \textcolor{red} \theta)$ 
										<br> for molecule $m$.
									</li>
									<li>
										Linear system: $\textcolor{blue} A \textcolor{red} \theta = \textcolor{green} E$, 
										<br>where $ \textcolor{blue} A \in \mathbb{R}^{n_\text{data} \times n_\text{feature}}$
									</li>
									<li>
										Kernel function: $\textcolor{blue} K_{ij} = k( \textcolor{blue} x_i, \textcolor{blue} x_j)$,
										<br> $k: \textcolor{blue}{\mathcal{X}} \times \textcolor{blue}{\mathcal{X}} \mapsto \mathbb{R}$
									</li>
									<li>
										Neural networks: $z_i = \sigma_i(\textcolor{red} W_iz_{i-1} + \textcolor{red} b_i)$,
										<br> for $i=1,2,..n_\text{layer}; $ where $\textcolor{red} W_l$ and $\textcolor{red} b_l$ are weight matrix and bias vector of $l$th layer respectively,
										$\sigma_l$ is elementwise non-linear activation function, and $ \textcolor{blue}{z_0} \in \textcolor{blue}{\mathcal{X}}$
									</li>
								</ul>
							</div>
							<div class="right-column" style="font-family:'Comic Sans MS'; font-size: 20px">
								<h6 style="font-family:'Comic Sans MS'"><u>Optimization</u></h6>
								<ul>
									<li>
										General problem: $\min_{\rtheta} c(V, \textcolor{blue}{\mathcal{X}}, \rtheta, \textcolor{green}E)$
									</li>
									<li>
										Least squares objective function:
										<br> $\min_{\rtheta} \sum_{m \in M_\text{train}} \Big(V(\textcolor{blue}{x}_m, \rtheta) - \gE_m\Big)^2$
									</li>
									<li>
										Solvers for linear systems:
										<br> Gaussian elimination, CGLS
									</li>
									<li>
										Solvers for nonlinear systems: LM, BFGS, SGD
									</li>
								</ul>
							</div>
						</div>
					</section>
					<section>
						<h4 style="color:green; font-family:'Comic Sans MS'">Evaluation</h4>
						<div style="position: absolute; left:-150px; font-family:'Comic Sans MS'; font-size: 25px">
							<ul>
								<li>
									Evaluation of test data (out of sample data).
								</li>
								<li>
									MAE: 
									\[
										\text{MAE} = \frac{1}{|M_\text{test}|}\sum_{m \in M_\text{test}}|V(\textcolor{blue}{x}_m, \rtheta) - \gE|
									\]
								</li>
								<li>
									RMSE: 
									\[
										\text{RMSE} = \sqrt{\frac{1}{|M_\text{test}|} \sum_{m \in M_\text{test}} \Big(V(\textcolor{blue}{x}_m, \rtheta) - \gE_m\Big)^2}
									\]
								</li>
								<li>
									K-fold cross validation
								</li>
								<li>
									Automatic evaluation by <strong>Hyperparameter tuning</strong>
								</li>
							</ul>
						</div>
					</section>
				</section>
				<!-- ========== Pair pot chapter ================ -->
				<section> 
					<section id = "ppes" data-background-image="assets/images/bg_sakura.gif" data-background-opacity=0.45>
						<h3 style="color:blue; font-family:'Comic Sans MS',cursive;">Pair potential energy surface</h3>
						<div style="font-family:'Comic Sans MS',cursive; font-size: 35px;">
							<ul>
								<li>
									Pair potential basics
								</li>
								<li>
									Demo example: Lennard-Jones potential
								</li>
								<li>
									Ansatz for benchmark
								</li>
								<li>
									Benchmark results
								</li>
							</ul>
						</div>
					</section>
					<section data-visibility="hidden">
						<h3>Lennard-Jones potential</h3>
						<div class="slidecontainer">
							<input type="range" min="1" max="100" value="50" class="slider" id="myRange" oninput="slider_out()">
							<p>Value: <span id="demo"></span></p>
						</div>
						<script src="swd_draw.js"></script>
					</section>
					<section data-auto-animate>
						<h4 style="color:green; font-family:'Comic Sans MS'">Basic examples</h4>
						<div data-id="pp" style="position:relative; right:350px;">
							<img id="pp" src="assets/images/pp.png" alt="Two atoms illustration" style="width: 10vw; min-width: 200px;">
							$\cblue{r}_{ij} = \|\cblue x_i - \cblue x_j\|_2 $
						</div>
						<div style="position:relative; left:-300px; font-size: 30px">
							\[
								V(\rtheta, \textcolor{blue} r) = \frac{{\rtheta}_1}{\textcolor{blue} r^{12}} - \frac{{\rtheta}_2}{\textcolor{blue} r^{6}}
							\]
							\[
								V(\rtheta, \textcolor{blue} r) = \frac{{\rtheta}_0 + {\rtheta}_1\textcolor{blue} r + .. + {\rtheta}_n\textcolor{blue} r^n}{{\rtheta}_0 + {\rtheta}_1\textcolor{blue} r + .. + {\rtheta}_{n+6}\textcolor{blue} r^{n+6}}
							\]
						</div>
						<div style="position:relative; left:-200px; font-size: 30px">
							<ul>
								<li>
									Repulsive term $\approx {\color{blue}\mathcal{O}(r^{-12})}$ (LJ), or ${\color{blue}\mathcal{O}(r^{-1})}$ (Quantum theory).
								</li>
								<li>
									Attractive term $\approx {\color{blue}\mathcal{O}(r^{-6})}$ (Van der Waals & Quantum theory).
								</li>
							</ul>
						</div>
						<div style="position:relative; right:-300px; top:-550px">
							<img src="assets/plots/plot_H2.svg" alt="Two atoms illustration">
						</div>
					</section>
					<section data-auto-animate>
						<h4 style="font-family:'Comic Sans MS',cursive;">Demo: <span style="color:green; ">Lennard-Jones potential</span></h4>
						<div data-id="pp" style="position:relative; right:400px; top:30px;">
							<img src="assets/images/pp.png" alt="Two atoms illustration" style="width: 10vw; min-width: 330px;">
						</div>
						<div style="position:relative; right:350px; top:70px; font-size: 35px;">
							\[
								V_\text{LJ}(\textcolor{red} \epsilon, \textcolor{red}{\sigma}) = 4 \textcolor{red}\epsilon \Big[\Big(\frac{\textcolor{red} \sigma}{\textcolor{blue} r}\Big)^{12} - \Big(\frac{\textcolor{red} \sigma}{\textcolor{blue} r}\Big)^6\Big]
							\]
						</div>
						<div style="position:relative; left:450px; top:-400px;">
							<iframe id="demo_pp" style="width: 100%; height: 600px; transform: scale(1.0);"> <!-- Pluto.run(require_secret_for_open_links=false, require_secret_for_access=false) --> </iframe>
						</div>
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS'">Ansatz for benchmark</h4>
						<div id="ratpot1" style="position:relative; left:-150px; width:700px; border-width:2px; border-style: dotted; border-color: red; font-size: 25px;">
							<p style="color:red">RATPOT1</p>
							\[
								\begin{align*}
									\cgreen V &= \cred{c}_0 + P/S, \\
									P &= \cblue{Z_iZ_j}\left(\frac{1}{\cblue{r}}+ \cred{c}_1 \cblue{r}\right)+\cred{c}_2+\cred{c}_3 \cblue{r}^2+ ...+\cred{c}_{2m-1}\cblue{r}^{2m-2}, \\
									Q &= 1+(\cred{c}_{2m}+\cred{c}_{2m+1} \cblue{r} +...+\cred{c}_{3m} \cblue{r}^m)\cblue{r}, \\
									S &= 1+\cred{c}_1 (\cblue{r} Q)^2.
								\end{align*}
							\]
						</div>
						<div id="ratpot2" style="position:relative; left:-150px; width:600px; border-width:2px; border-style: dotted; border-color: green; font-size: 23px;">
							<p style="color:green">RATPOT2</p>
							\[
								\begin{align*}
									\cgreen V &= \cred{c}_0+P/Q, \\
									P &= \cred{c}_1\prod_{i=1}^m ((\cblue{r}-\cred{a}_i)^2+\cred{b}_i \cblue{r}), \\
									Q &= \cblue{r}(\cblue{r}+\cred{d}_1)\prod_{i=2}^{m+3}((\cblue{r}-\cred{c}_i)^2+\cred{d}_i \cblue{r}).
								\end{align*}
							\]
						</div>
						<div id="chipr" style="position:relative; left:540px; top:-400px; width:560px; border-width:2px; border-style: dotted; border-color: blue; font-size: 23px;">
							<p style="color:blue">CHIPR</p>
							\[
								\begin{align*}
									\cgreen{V} &= \frac{\cblue{Z_iZ_j}}{\cblue{r}^{\cred{\omega}}}\sum_{k=1}^M \cred{C}_ky_k, \\
									y_k &= \sum_{p=1}^m \cred{c}_{p}\text{ sech}^{\cred{\eta}_{p}}(\cred{\gamma}_{p}(\left[\cblue{r} - \cred{\zeta\beta}^{p-1}\right])).
								\end{align*}
							\]
						</div>
					</section>
					<section>
						<h4 style="color:green; font-family:'Comic Sans MS'">Pair potential benchmark</h4>
						<div style="position:relative; left:-325px;"> 
							<img src="assets/plots/pairpot_benchmark.png" style="width: 10vw; min-width: 630px;">
						</div>
						<div style="position:relative; left:325px; top:-530px; font-size: 20px;">
							<img src="assets/plots/pairpot_benchmark_OH+.png" style="width: 10vw; min-width: 630px;">
						</div>
					</section>
				</section> 
				<!-- ========== Bonding potential ch. ================ -->
				<section>
					<section id = "bpes" data-background-image="assets/images/bg_sakura.gif" data-background-opacity=0.45>
						<h3 style="color:blue; font-family:'Comic Sans MS',cursive;">Bonding potential energy surface</h3>
						<div style="font-family:'Comic Sans MS',cursive; font-size: 35px;">
							<ul>
								<li>
									Primitive features
								</li>
								<li>
									Advanced features
								</li>
								<li>
									Bonding potential model
								</li>
								<li>
									Useful tool: automatic differentiation
								</li>
								<li>
									Benchmark results
								</li>
							</ul>
						</div>
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS'">Primitive features</h4>
						<div id="bondf" style="position:absolute; left:-150px; width:450px; border-width:2px; border-style: dotted; border-color: blue; font-size: 16px;">
							<p><u>Bonding functions</u>:</p>
							\[
								t := t(\cblue r) = \left(\frac{\cblue r^2 - {\color{red}\underline{r}}^2}{{\color{red}\overline{r}}^2 - \cblue r^2}\right)^{\cred{e}},
							\]
							\[
								s := s(\cblue r) =
								\begin{cases}
									1 & \cblue r < {\color{red}\underline{r}} \\
									\frac{t_0}{t + t_0} & {\color{red}\underline{r}} \leq \cblue r \leq {\color{red}\overline{r}}, \\
									0 & {\color{red}\overline{r}} < \cblue r
								\end{cases}
							\]
							\[
								p_1(s) := s, ~ p_{\color{red}d}(s):= s(1-s)T_{{\color{red}d}-2}(1-2s) \text{ for } {\color{red}d} > 1,
							\]
							\[
								{\color{blue}b}_{ij{\color{red}d}} := p_{\color{red}d}(s)\text{ for }{\color{red}d}=1,2,...
							\]
							<img src="assets/plots/bonding_functions.png" style="width: 10vw; min-width: 400px;" alt="Bonding function plot">
						</div>
						<div id="bumpf" style="position:absolute; left:310px; width:800px; height:600px; border-width:2px; border-style: dotted; border-color: red; font-size: 16px;" >
							<div style="margin-left:-350px;">
								<p><u>Bump functions</u>:</p>
								<ul>
									<li>
										$\rho := \cblue r/{\color{red}\hat r_{ij}}, ~ q := \frac{\color{red}{N}}{1+\rho} \in (0, N]$
									</li>
									<li>
										$h_k := h_k(q) = [1 - (q - k)^2]^3_+$
									</li>
									<li>
										$w := w(q) = \sum_k h_k$
									</li>
								</ul>
								<div>
									<p>Primitive features := (bumps, wavelets):</p>
									\[
										{\color{blue}z}_{ij} := (h_k/w, (q-k)h_k/w).
									\]
								</div>
								<img src="assets/plots/BUMP_k=5.png" style="width: 10vw; min-width: 400px;" alt="Bonding function plot">
								<img src="assets/plots/BUMP_hw_N=7.png" style="position:absolute; right:20px; top:-0px; width: 10vw; min-width: 350px;" alt="Bonding function plot">
								<img src="assets/plots/wavelets_qhw_N=7.png" style="position:absolute; right:20px; top:300px; width: 10vw; min-width: 350px;" alt="Bonding function plot">
							</div>
						</div>
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS'">Advanced features</h4>
						<h6 style= "font-family:'Comic Sans MS'; font-size: 19px;" ><b>For atom $i$:</b></h6>
						<div id="refpp" style="position:absolute; left:-150px; width:fit-content; padding:20px; border-width:2px; border-style: dotted; border-color: blue; font-size: 20px; text-align: left;">
							<p><u>Reference pair potential</u>:</p>
							\[
								{\color{blue}U}[i] := \sum_{j \neq i}V_{ij}.
							\]
							<p>Choices of pair potentials:</p>
							<ol>
								<li> 
									Nonlinear pair-pot (<span style="color: blue;">cheap, least accurate</span>):
									\[
										V_{ij} := V(\cblue r) = 
										\begin{cases}
											\infty & \text{ if } \cblue r \leq {\color{red}r_h} \\
											-{\color{red}C}({\color{red}r_C}^2 - \cblue r^2)^{\color{red}g}\frac{\cblue r^2 - {\color{red}r_0}^2}{\cblue r^2 - {\color{red}r_h}^2} & \text{ if } {\color{red}r_h} < \cblue r \leq {\color{red}r_C} \\
											0 & \text{ else}
										\end{cases}
									\]
								</li>
								<li>
									RATPOT$_{1,2,..}$ (<span style="color: blue;">most expensive, most accurate</span>)
								</li>
								<li>
									Bump functions (<span style="color: blue;">middle ground</span>)
								</li>
							</ol>						
						</div>
						<div id="coordvec" style="position:absolute; left:500px; width:500px; padding:20px; border-width:2px; border-style: dotted; border-color: red; font-size: 17px; text-align: left;">
							<p><u>Coordination vectors</u>:</p>
							\[
								{\color{blue}Y}_{\color{red}d}[i] := \sum_{j\neq i}{\color{blue}b}_{ij{\color{red}d}},
							\]
							<ul>
								<li>
									$\cblue Y_1[i]$ is approximately proportional to coordination number of atom $i$. 
								</li>
								<li>
									For $\cred d>1$, $\cblue Y_{\cred d}[i]$ measures the partial bonding.
								</li>
							</ul>
						</div>
						<div id="grammat" style="position:absolute; top:380px; left:500px; width:500px; padding:20px; border-width:2px; border-style: dotted; border-color: green; font-size: 17px; text-align: left;">
							<p><u>Gram matrices</u>:</p>
							\[
								{\color{blue}G}[i]_{{\color{red}d}_1{\color{red}d}_2} := r_{{\color{red}d}_1}[i] \cdot r_{{\color{red}d}_2}[i],
							\]
							where
							\[
								r_{\color{red}d}[i] := \sum_{j \neq i} {\color{blue}b}_{ij{\color{red}d}}(\cblue x_j - \cblue x_i) \in \mathbb{R}^3.
							\]
							The Gram matrices contain implicit information of <span style="color:blue">bond angles</span> and <span style="color:blue">torsion angles</span>.
						</div>
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS'">Bonding potential model</h4>
						<div style="text-align: left; font-size: 18px;">
							<ul>
								<li>
									Basis functions:
									\[
										{\color{blue}\Phi := (U, Y_1, UY_1, Y_1^2,Y_2,G_{11},...,Y_1^5,...,G_{23})}.
									\]
								</li>
								<li>
									Atom $i$ energy contribution:
									\[
										\epsilon[i] = A[i] - \sqrt{B[i] + C[i]},
									\]
									where $A$ is of the form
									\[
										A[i] = \frac{\sum\limits_k {\color{red}\theta}_k {\color{blue}\Phi}_k[i]}{1 + \left(\sum\limits_k {\color{red}\theta'}_k {\color{blue}\Phi}_k[i] \right)^2},
									\]
									and $B,C$ are of the form
									\[
										T[i]  = \frac{\left(\sum\limits_k {\color{red}\theta}_k {\color{blue}\Phi}_k[i]\right)^2}{1 + \left(\sum\limits_k {\color{red}\theta'}_k {\color{blue}\Phi}_k[i] \right)^2}.
									\]
									<b>Potential energy</b> at a given conformation:
									\[
									\cgreen V = \sum_i \epsilon[i].
									\]
								</li>
							</ul>
							<img src=""> 
						</div>
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS'">Automatic differentiation!</h4>
						<div style="position: absolute; left:-150px; text-align: left; font-size: 15px; padding:20px; width:400px; border-width:2px; border-style: dotted; border-color: blue;">
							<ul>
								<li>
									Three well known classes of differentiation: <b>symbolic</b> differentiation, <b>finite</b> difference, <span style="color:red"><b>automatic</b></span> differentiation
								</li>
								<li>
									<b>Finite</b> difference:
									<ul>
										<li>
											(+) Generic, easiest to implement
										</li>
										<li>
											(-) Inaccurate (approximate), slow, <b>commits cardinal sins of numerical computation</b>: 
											“<em>thou shalt not add small numbers to big numbers</em>”, and 
											“<em>thou shalt not subtract numbers which are approximately equal</em>”.
										</li>
									</ul>
								</li>
								<li>
									<b>Symbolic</b> differentiation:
									<ul>
										<li>
											(+) Accurate (exact)
										</li>
										<li>
											(-) Not generic, cumbersome to implement (expression complexity grows rapidly by addition of new variables).
										</li>
									</ul>
								</li>
								<li>
									<b><span style="color:red">Automatic differentiation (AD)</span></b>: computes the derivative of a function by "reading" the function's algorithm. 
									Modes: <span style="color:red">forward AD</span>, <span style="color:red">reverse AD</span>.
									<ul>
										<li>
											(+) Accurate (exact), fast, generic.
										</li>
										<li>
											(-) ?
										</li>
									</ul>
								</li>
							</ul>
						</div>
						<div style="position: absolute; left:300px; text-align: left; font-size: 15px; padding:20px; width:400px;">
							<u>Reverse mode AD illustration</u>:
							<ul>
								<li>
									Function: $f(x) = \cblue{(x_1 + x_2)(x_1 + 1)}, ~~ f([\cblue{2,1}]) = 9$
								</li>
								<li>
									Gradient: $g(x) := \Big[\cgreen{\frac{\partial f}{\partial x_1}, \frac{\partial f}{\partial x_2}}\Big]^T $ 
									<br>$= [2x_1 + x_2 + 1, ~ x_1 + 1]^T, ~~ g([\cblue{2,1}]) = [\cgreen{6, 3}]^T.$
								</li>
								<li>
									Forward sweep:
									\[
										\begin{split}
											\cred{v_1} &:= x_1 + x_2 = 3, \\
											\cred{v_2} &:= x_1 + 1 = 3, \\
											\cred{v_3} &:= \cred{v_1v_2} = 9, \\
											f &:= \cred{v_3} = 9.
										\end{split}
									\]
								</li>
								<li>
									Backward sweep:
									\[
										\begin{split}
											\frac{\partial f}{\partial x_1} &= 
											\frac{\partial f}{\partial v_3} 
											\frac{\partial v_3}{\partial v_1}
											\frac{\partial v_1}{\partial x_1} +
											\frac{\partial f}{\partial v_3} 
											\frac{\partial v_3}{\partial v_2}
											\frac{\partial v_2}{\partial x_1}, \\
											\cgreen{\frac{\partial f}{\partial x_1}} &= 
											1 \cdot \cred{v_2} \cdot x_2 + 1 \cdot \cred{v_1} \cdot 1 = \cgreen 6. 
										\end{split}
									\]
									\[
										\begin{split}
											\frac{\partial f}{\partial x_2} &=
											\frac{\partial f}{\partial v_3}
											\frac{\partial v_3}{\partial v_1}
											\frac{\partial v_1}{\partial x_2},\\
											\cgreen{\frac{\partial f}{\partial x_2}} &= 1 \cdot \cred{v_2} \cdot 1 = \cgreen 3. 
										\end{split}
									\]
								</li>
							</ul>
							<img src="assets/images/reverse_AD.svg" style="position:absolute; width: 10vw; min-width: 400px; " alt="reverse AD example"> 
						</div>
					</section>
					<section style="font-family:'Comic Sans MS'">
						<h4 style="color:green; font-family:'Comic Sans MS'">Global potential benchmark</h4>
						<div style="font-size: 25px; margin-right:auto; width:fit-content; height:fit-content; border-width:2px; padding:20px; border-style: dotted; border-color: blue;">
							Current best obtained RMSE (in Hartree)
							<div>
								<img src="assets/images/bondpot_benchmark.png" style="width: 10vw; min-width: 400px; " alt="Global potential benchmark"> 
							</div>
							<div style="position: absolute; top: 75px; left:550px; width: fit-content; border-width:2px; padding:20px; border-style: dotted; border-color: red;">
								<p>BondPOT optimization timing:</p>
								<ul>
									<li>
										Finite differences: 523.82s
									</li>
									<li>
										Reverse AD: <span style="color:red"><b>129.02s</b></span>
									</li>
								</ul>
							</div>
						</div>
						<div style="text-align: left; font-size: 25px; padding:20px"> 
							<ul>
								<li>
									Uses least squares objective function
								</li>
								<li>
									Uses Levenberg–Marquardt algorithm from <span style="color:blueviolet">LsqFit.jl</span>
								</li>
								<li>
									Uses multistart for the optimization routine
								</li>
								<li>
									Data split <span style="color:blue"> train:test = 80% : 20% </span>
								</li>
								<li>
									Benchmark against <span style="color:blue">CHIPR</span>
								</li>
							</ul>
						</div>
						<img src="assets/images/logo_julia.png" style="position:absolute; top:550px; left:800px; width:100px;">
					</section>
				</section>
				<!-- ========== ROSEMI ================ -->
				<section> 
					<section id = "rosemi" data-background-image="assets/images/bg_sakura.gif" data-background-opacity=0.45>
						<h3 style="color:blue; font-family:'Comic Sans MS',cursive; font-size: 45px;">Robust Shepard model for interpolation (ROSEMI)</h3>
						<div style="font-family:'Comic Sans MS',cursive; font-size: 35px;">
							<ul>
								<li>
									Model definition
								</li>
								<li>
									Optimizing the model
								</li>
								<li>
									Benchmark results
								</li>
							</ul>
						</div>
					</section>
					<section style="font-family:'Comic Sans MS',cursive;">
						<h4 style="color:green; font-family:'Comic Sans MS'">Model definition</h4>
						<div style="position: absolute; left:-150px; text-align: left; font-size: 20px; padding:20px; width: 600px; border-width:2px; border-style: dotted; border-color: blue;">
							Improvement of the Shepard model (D. Shepard (1968), R. Franke (1982)), 
							<br> <b>Robust Shepard model</b> for interpolation (<b>ROSEMI</b>):
							\[
								V_K(\cblue{w}):=R_K(\cblue{w})/S_K(\cblue{w}) ~~~ \text{ for } \cblue{w} \in \mathbb{R}^m \setminus \{\cblue{w}_k\mid k\in K \},
							\]
							where
							<div>
								<ul>
									<li>
										$R_K(\cblue{w}) :=\sum_{k\in K} \frac{V_k(\cblue{w})}{D_k(\cblue{w})}$
									</li>
									<li>
										$S_K(\cblue{w}):=\sum_{k\in K} \frac{1}{D_k(\cblue{w})}$
									</li>
									<li>
										$D_k(\cblue{w}) = \|\cblue{w}-\cblue{w}_k\|_2^2$
									</li>
								</ul>
							</div>
							<br>
							Extending $V_K$:
							\[
								V_K(\cblue w):=
								\begin{cases}
									V_k(\cblue w_k)      & \text{if } \cblue w=\cblue w_k \text{ with } k\in K, \\
									R_K(\cblue w)/S_K(\cblue w) & \text{otherwise}.
								\end{cases}
							\]
						</div>
						<div style="position: absolute; left: 500px; text-align: left; font-size: 17px; padding:20px; width: 570px; border-width:2px; border-style: dotted; border-color: red;">
							Interpolation condition:
							\[
								V_k(\cblue w_k)= \cgreen E_k.
							\]
							Ansatz based on the interpolation condition:
							<ul>
								<li>
									non specific condition:
									\[
										V_k(\cblue w)= \cgreen E_k+\sum_b \cred \theta_{kb}\Big( \phi_b(w) - \phi_b(\cblue w_k) \Big)
									\]
								</li>
								<li>
									with force condition (equilibrium geometry):
									\[
										V_k(\cblue w)= \cgreen E_k+\sum_b \cred \theta_{kb}\phi_{kb}(\cblue w),
									\]
									where
									<ul>
										<li>
											$\phi_{kb}(\cblue w):=\phi_b(\cblue w)-\phi_b(\cblue w_k)-\phi_b'(\cblue w_k)(\cblue w-\cblue w_k)$ 
											<br>$\text{for } k\in K,~b\in B$
										</li>
										<li>
											$\phi_b'(\cblue w)=\frac{d\phi_b}{dw} \in \mathbb{R}^{1\times m}$
										</li>
									</ul>
								</li>
							</ul>
					</section>
					<section style="font-family:'Comic Sans MS',cursive;">
						<h4 style="color:green; font-family:'Comic Sans MS'">Optimizing the model</h4>
						<div style="position: absolute; left:-150px; text-align: left; font-size: 15px; padding:15px; width: 600px; border-width:2px; border-style: dotted; border-color: blue;">
							Interpolation <b>deviation</b> when data point $j$ is removed from $K$:
							\[
								\Delta_{jK}(\cblue{w}, \cred{\theta}):=\frac{V_K(\cblue{w}, \cred{\theta})-V_j(\cblue{w}, \cred{\theta})}{D_j(\cblue{w})S_K(\cblue{w})-1}.
							\]
							Error measurements:
							<li>
								Mean absolute deviation:
								\[
									\text{MAD}_K(\cblue{w}, \cred{\theta}) := \frac{1}{|K|}\sum_{j\in K}|\Delta_{jK}(\cblue{w}, \cred{\theta})|.
								\]
							</li>
							<li>
								Root mean squared deviation:
								\[
									\text{RMSD}_K(\cblue{w}, \cred{\theta}) := \sqrt{\frac{1}{|K|}\sum_{j\in K}\Delta_{jK}(\cblue{w}, \cred{\theta})^2}.
								\]
							</li>
							Linear system form:
							\[
									\Delta_{jK}(\cblue w_m, \rtheta) = \sum_{kl} \cblue A_{jm, kl} \rtheta_{kl} - \cgreen b_{jm} 
									= (\cblue A\rtheta - \cgreen b)_{jm}
							\]
							where
							<div>
								<ul>
									<li>
										\[
											\cblue A_{jm, kl} = \frac{\phi_{kl}(\cblue w_m)(1 - \gamma_k(\cblue w_m) \delta_{jk})}{\gamma_k(\cblue w_m) \alpha_j(\cblue w_m)}
										\]
									</li>
									<li>
										\[
											\cgreen b_{jm} = \Big(\cgreen E_j - \sum_k\frac{\cgreen E_k}{\gamma_k(\cblue w_m)}\Big)/\alpha_j(\cblue w_m)
										\]
									</li>
									<li>
										\[
											\gamma_k(\cblue w) := D_k(\cblue w)S_K(w), ~ \alpha_j(\cblue w) := \gamma_j(\cblue w)-1
										\]
									</li>
								</ul>
							</div> 
						</div>
						<div style="position: absolute; left:500px; text-align: left; font-size: 20px; padding:15px; width: 500px; border-width:2px; border-style: dotted; border-color: red;">
							Objective function:
							\[
								f_{\text{obj}}(\rtheta) := |K| \sum_m \text{RMSD}_K(\cblue w_m, \rtheta)^2 = \|\cblue A \rtheta - \cgreen b\|_2^2.
							\]
							Memory efficient optimization with conjugate gradient for least squares (<b>CGLS</b>):
							\[
								\rtheta \leftarrow \text{CGLS}(\cblue Au, \cblue A^Tv, \cgreen b).
							\]
							The matrix-vector products:
							<div>
								<ul>
									<li>
										\[
											\cblue Au = \sum_{kl} \frac{\cblue \phi_{m, kl} u_{kl} (1-\gamma_{m k}\delta_{jk})}{\gamma_{mk}\alpha_{mj}}
										\]
									</li>
									<li>
										\[
											\cblue A^T v = \sum_{jm} \frac{\cblue \phi_{m, kl} v_{jm} (1-\gamma_{m k}\delta_{jk})}{\gamma_{mk}\alpha_{mj}}
										\]
									</li>
								</ul>
							</div>
						</div>
					</section>
					<section style="font-family:'Comic Sans MS',cursive;">
						<h4 style="color:green; font-family:'Comic Sans MS'">Benchmark results</h4>
						<div style="position: absolute; left:-150px; font-size: 25px; padding:15px; width: 700px; border-width:2px; border-style: dotted; border-color: blue;">
							<u><span style="color: blue;">Pair potential benchmark</span></u>
							<div style="text-align: left; font-size: 20px;">
								<ul>
									<li>
										Error measure using <b>test RMSE</b> (in Hartree unit)
									</li>
									<li>
										Uses <span style="color:blue">5-fold</span> cross validation for train-test split
									</li>
									<li>
										Uses <span style="color:blueviolet">CGLS</span> from <span style="color:blueviolet">Krylov.jl</span> for training
									</li>
									<li>
										Uses <span style="color:blueviolet">LHSampler</span> from <span style="color:blueviolet">Hyperopt.jl</span> for hyperparameter optimization
									</li>
									<li>
										Total optimization timing ranges from 200s-2000s (depending on dataset size)
									</li>
								</ul>
								<img src="assets/images/rosemi_pairpot_benchmark.png">
							</div>
						</div>
						<div style="position: absolute; left:600px; font-size: 25px; padding:15px; width: 450px; border-width:2px; border-style: dotted; border-color: red;">
							<u><span style="color: red;">QM9 benchmark</span></u>
							<div style="text-align: left; font-size: 15px;">
								<ul>
									<li>
										Error measure using <b>test MAE</b> (in kcal/mol unit)
									</li>
									<li>
										Uses <span style="color:blue"><b>100</b></span> out of <b>130k</b> molecules for training, while the rest are for testing (<b>QM9 challenge!</b>)
									</li>
									<li>
										$t_s$ is CPU time for solving, $t_p$ is CPU time for prediction
									</li>
								</ul>
								<img src="assets/images/rosemi_qm9_benchmark.png">
							</div>
						</div>
						<img src="assets/images/logo_julia.png" style="position:absolute; top:500px; left:800px; width:100px;">
						<img src="assets/images/logo_vsc.jpg" style="position:absolute; top:600px; left:800px; width:100px; height:100px">
					</section>
				</section>
				<!-- ========== QM9 Challenge ================ -->
				<section>
					<section id = "qm9" data-background-image="assets/images/bg_sakura.gif" data-background-opacity=0.45>
						<h3 style="color:blue; font-family:'Comic Sans MS',cursive; font-size: 45px;">Learning equilibrium geometries with minimal supervision (QM9 challenge)</h3>
						<div style="font-family:'Comic Sans MS',cursive; font-size: 35px;">
							<ul>
								<li>
									Motivation
								</li>
								<li>
									Molecular selection
								</li>
								<li>
									Delta machine learning
								</li>
								<li>
									Intermediate benchmarks
								</li>
								<li>
									Optimizing hyperparameters and training set
								</li>
								<li>
									Explainable AI: 2D PCA of current best model
								</li>
							</ul>
						</div>
					</section>
					<section style="font-family:'Comic Sans MS',cursive;">
						<h4 style="color:green; font-family:'Comic Sans MS'">Motivation</h4>
						<img src="assets/images/qm9c.svg" style="width:650px;">
					</section>
					<section style="font-family:'Comic Sans MS',cursive;">
						<h4 style="color:green; font-family:'Comic Sans MS'">Molecular selection</h4>
						<div style="font-size: 25px; width: 1000px; border-width:2px; border-style: dotted; border-color: blue;">
							Why do we need training molecule selection?
							<img src="assets/images/selection_example.svg" style="width:1000px;">
						</div>
					</section>
					<section style="font-family:'Comic Sans MS',cursive;">
						<h4 style="color:green; font-family:'Comic Sans MS'">Molecular selection (cont.)</h4>
						<div style="font-size: 25px;">
							<u>How to do the selection</u>
						</div>
						<div style="position: absolute; left:-150px; font-size: 17px; width: 600px; border-width:2px; border-style: dotted; border-color: blue;">
							Farthest point sampling
							<img src="assets/images/gifs/fps.gif">
						</div>
						<div style="position: absolute; left:500px; font-size: 17px; width: 600px; border-width:2px; border-style: dotted; border-color: red;">
							Usequence
							<img src="assets/images/gifs/useq.gif">
						</div>
					</section>
				</section>
				<!----------- Summary of the thesis -------------->
				<section>
					<section id = "summary" data-background-image="assets/images/bg_sakura.gif" data-background-opacity=0.3></section>
					<h3 style="color:blue; font-family:'Comic Sans MS',cursive; font-size: 45px;">Summary of the thesis...</h3>
					<div style="font-size: 30px;">
						<ul>
							<li>
								Main goal of the thesis: <span style="color:red">fitting</span> functions that predicts <span style="color:green">energies</span> of <span style="color:blue">chemical systems</span>, $\cgreen E \approx f(\cblue x, \cred \theta)$.
							</li>
							<li>
								High accuracy <span style="color:blue">pair potential datasets</span> <span style="color:red">fitting</span> by variants of <span style="color:blueviolet">rational potentials</span>.
							</li>
							<li>
								Global potential energy surface for <span style="color:blue">small clusters</span> <span style="color:red">fitting</span> by <span style="color:blueviolet">bonding potential</span>, inspired from embedded atom method.
							</li>
							<li>
								<span style="color:blueviolet">Robust Shepard model</span> for <span style="color:red">interpolation</span> of chemical systems, from global <span style="color:blue">pair potential datasets</span> to large <span style="color:blue">dataset of equilibrium geometries</span>. 
							</li>
							<li>
								Tackling <span style="color:blue">QM9</span> challenge (<span style="color:red">fitting</span> with < 1% total molecules, the rest are for testing) by <span style="color:blueviolet">delta machine learning</span>, <span style="color:blueviolet">molecular selection</span>, and <span style="color:blueviolet">hyperparameter optimization</span>.
							</li>
						</ul>
					</div>
				</section>
			</div>
		</div>
		<script> /* load links for demos */
			let pluto_link_pp = "http://localhost:1235/edit?id=cb29ee60-8a59-11ef-306a-ab3b525f3f46"; /* for pair potential demo*/
			document.getElementById("demo_pp").src = pluto_link_pp;
		</script>
		<script src="../../../etc/reveal.js/dist/reveal.js"></script>
		<script src="../../../etc/reveal.js/plugin/notes/notes.js"></script>
		<script src="../../../etc/reveal.js/plugin/markdown/markdown.js"></script>
		<script src="../../../etc/reveal.js/plugin/highlight/highlight.js"></script>
		<script src="../../../etc/reveal.js/plugin/math/math.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
				slideNumber: "h/v",
				//  resoultiuon:
				//width: 1920,
  				//height: 1080,
				katex: {
					macros:{
						'\\rtheta' : '\\textcolor{red}{\\theta}',
						'\\gE': '\\textcolor{green}{E}',
						'\\cred':'\\textcolor{red}{#1}',
						'\\cgreen':'\\textcolor{green}{#1}',
						'\\cblue':'\\textcolor{blue}{#1}'
					}
				},
				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX ]
			});
			Reveal.toggleOverview(true);
		</script>
	</body>
</html>